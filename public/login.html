<!DOCTYPE html>
<html>
	<head>
		<meta charset="utf-8">
		<title>vrcollab</title>
        <script type="module">
			import elements from '/api/elements/lib';

			(async (elements) => {
				document.getElementById('loginform').addEventListener('submit', async (event) => {
					event.preventDefault();
					localStorage.removeItem('userId');
					var username = event.target[0].value;
					var password = event.target[1].value;
					var userId = await elements.login(username, password);
					if (userId) {
						localStorage.setItem('username', username);
						localStorage.setItem('userId', userId);
					}
					if (!userId) return false;
					if (location.search) {
						var returnUrl = location.search.substr(1);
						location.href = returnUrl;
					}
				});
			})(elements);
		</script>
	</head>
	<body>
		<h1>Login</h1>
		<form id="loginform">
			<input type="text" name="username" />
			<input type="password" name="password" />
			<button type="submit">Login</button>
		</form>
		<p><a href="register.html">Register</a></p>
	</body>
</html>